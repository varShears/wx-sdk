!function(o,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((o="undefined"!=typeof globalThis?globalThis:o||self)["npmpackage-name"]={})}(this,function(o){"use strict";function e(o,e){this.appMsg={sys:{version_code:"",application_platform:"",equipment_model:"",os:"",os_version:"",equipment_brand:"",screen_size:"",sdk_version:""},et:{event_name:"",common_info:{path:"",client_time:0,lang:"",event_type:"",network_mode:"",userInfo:null}}},this.url=o,this.method=e}e.prototype.init=function(){var o;(o=this).canIUse(),o.getSysInfo(),o.getAccountInfo(),o.getUserInfo(),o.appActive(),o.checkNetworkStatus(),o.getNetworkType(),o.routerWatcher()},e.prototype.getSysInfo=function(){!function(o){try{var e=wx.getSystemInfoSync();o.appMsg.sys.version_code=e.SDKVersion,o.appMsg.sys.application_platform=e.platform,o.appMsg.sys.equipment_model=e.model,o.appMsg.sys.os=e.system.split(" ")[0],o.appMsg.sys.os_version=e.system.split(" ")[1],o.appMsg.sys.equipment_brand=e.brand,o.appMsg.sys.screen_size=e.safeArea,o.appMsg.sys.sdk_version=1,o.appMsg.et.common_info.lang=e.language,console.log("sysInfo",e)}catch(o){console.error(o)}}(this)},e.prototype.getAccountInfo=function(){var o;o=wx.getAccountInfoSync(),console.log("accountInfo",o)},e.prototype.getUserInfo=function(){var n;n=this,wx.getUserInfo({success:function(o){var e=o.userInfo;e.nickName,e.avatarUrl,e.gender,e.province,e.city,e.country,n.appMsg.et.common_info.userInfo=o,console.log("userInfo",o)}})},e.prototype.appActive=function(){var e;e=this,wx.onAppShow(function(o){console.log("appshow",o),e.appMsg.et.event_name="appShow",e.appMsg.et.common_info.event_type="appShow",e.upload()}),wx.onAppHide(function(o){console.log("apphide",o),e.appMsg.et.event_name="appHide",e.appMsg.et.common_info.event_type="appHide",e.uplaod()})},e.prototype.routerWatcher=function(){var e;e=this,wx.onAppRoute(function(o){e.appMsg.et.common_info.path=o.path,e.appMsg.et.common_info.event_type="router",e.appMsg.et.event_name="routerChange",e.upload()})},e.prototype.checkNetworkStatus=function(){var e;e=this,wx.onNetworkStatusChange(function(o){console.log(o.isConnected),console.log(o.networkType),o.isConnected||(console.error("disconnect!"),e.destroy())})},e.prototype.getNetworkType=function(){var e;e=this,wx.getNetworkType({success:function(o){o=o.networkType;e.appMsg.et.common_info.network_mode=o,console.log("networkType",o)}})},e.prototype.canIUse=function(){wx.canIUse("getSystemInfoSync")||console.error("getSystemInfoSync can not use"),wx.canIUse("onAppShow")||console.error("onAppShow can not use"),wx.canIUse("onAppHide")||console.error("onAppHide can not use"),wx.canIUse("getLocation")||console.error("getLocation can not use"),wx.canIUse("onLocationChange")||console.error("onLocationChange can not use"),wx.canIUse("getNetworkType")||console.error("getNetworkType can not use"),wx.canIUse("onNetworkStatusChange")||console.error("onNetworkStatusChange can not use"),wx.canIUse("getUserInfo")||console.error("getUserInfo can not use"),wx.canIUse("getAccountInfoSync")||console.error("getAccountInfoSync can not use")},e.prototype.getLocation=function(){wx.getLocation({type:"wgs84",success:function(o){o.latitude,o.longitude,o.speed,o.accuracy,console.log("location",o)}})},e.prototype.location=function(){wx.onLocationChange(function(o){console.log("locationChange",o)})},e.prototype.destroy=function(){wx.offAppShow(),wx.offAppHide(),wx.offLocationChange(),wx.offNetworkStatusChange()},e.prototype.upload=function(){var o;(o=this).appMsg.et.common_info.client_time=(new Date).getTime(),wx.request({method:o.method,url:o.url,data:o.appMsg,header:{"content-type":"application/json"},success:function(o){console.log(o.data)}})},e.prototype.handle=function(o,e,n){!function(o,e,n,t){console.log(Array.prototype.slice.call(arguments)[0]),o.appMsg.et.event_name=n,o.appMsg.et.common_info.event_type=e,o.appMsg.et.common_info.others=t,console.log(o.appMsg.et),console.log("_appMsg",o.appMsg),o.upload()}(this,o,e,n)},o.Maidian=e,Object.defineProperty(o,"__esModule",{value:!0})});
