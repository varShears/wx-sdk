!function(o,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((o="undefined"!=typeof globalThis?globalThis:o||self)["npmpackage-name"]={})}(this,function(o){"use strict";function e(o){var e=function(){for(var o=[],e="0123456789abcdef",n=0;n<36;n++)o[n]=e.substr(Math.floor(16*Math.random()),1);return o[14]="4",o[19]=e.substr(3&o[19]|8,1),o[8]=o[13]=o[18]=o[23]="-",o.join("")}();console.log(e),wx.setStorage({key:"uuid",data:e}),o.appMsg.sys.equipment_unique_id=e}var n,t=(function(o){function e(){return o.exports=e=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var n,t=arguments[e];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},e.apply(this,arguments)}o.exports=e}(n={exports:{}}),n.exports);function s(o,e,n){this.appMsg={sys:{version_name:"",application_platform:"",equipment_model:"",os:"",os_version:"",equipment_brand:"",screen_size:"",sdk_version:"",equipment_unique_id:""},et:{event_name:"",common_info:{path:"",client_time:0,lang:"",event_type:"",network_mode:""}}},this.url=o,this.method=e,this.appId=null,this.appSecret=n,this.app_openid=null}s.prototype.init=function(){var o;(o=this).canIUse(),o.getSysInfo(),o.getAccountInfo(),o.getUserInfo(),o.appActive(),o.checkNetworkStatus(),o.getNetworkType(),o.routerWatcher(),o.getUniqueId()},s.prototype.getUniqueId=function(){e(this)},s.prototype.getSysInfo=function(){!function(o){try{var e=wx.getSystemInfoSync();o.appMsg.sys.version_name=e.SDKVersion,o.appMsg.sys.application_platform=e.platform,o.appMsg.sys.equipment_model=e.model,o.appMsg.sys.os=e.system.split(" ")[0],o.appMsg.sys.os_version=e.system.split(" ")[1],o.appMsg.sys.equipment_brand=e.brand,o.appMsg.sys.screen_size=e.safeArea,o.appMsg.sys.sdk_version=1,o.appMsg.et.common_info.lang=e.language,console.log("sysInfo",e)}catch(o){console.error(o)}}(this)},s.prototype.getAccountInfo=function(){var o,e;o=this,e=wx.getAccountInfoSync(),o.appId=e.miniProgram.appId,console.log("accountInfo",e)},s.prototype.getUserInfo=function(){var n;n=this,wx.getUserInfo({success:function(o){var e=o.userInfo;e.nickName,e.avatarUrl,e.gender,e.province,e.city,e.country,n.appMsg.et.common_info=t({},n.appMsg.et.common_info,o),console.log("userInfo",o)}})},s.prototype.appActive=function(){var e;e=this,wx.onAppShow(function(o){console.log("appshow",o),e.appMsg.et.event_name="appShow",e.appMsg.et.common_info.event_type="appShow",e.upload()}),wx.onAppHide(function(o){console.log("apphide",o),e.appMsg.et.event_name="appHide",e.appMsg.et.common_info.event_type="appHide",e.uplaod()})},s.prototype.routerWatcher=function(){var e;e=this,wx.onAppRoute(function(o){e.appMsg.et.common_info.path=o.path,e.appMsg.et.common_info.event_type="router",e.appMsg.et.event_name="routerChange",e.upload()})},s.prototype.checkNetworkStatus=function(){var e;e=this,wx.onNetworkStatusChange(function(o){console.log(o.isConnected),console.log(o.networkType),o.isConnected||(console.error("disconnect!"),e.destroy())})},s.prototype.getNetworkType=function(){var e;e=this,wx.getNetworkType({success:function(o){o=o.networkType;e.appMsg.et.common_info.network_mode=o,console.log("networkType",o)}})},s.prototype.canIUse=function(){wx.canIUse("getSystemInfoSync")||console.error("getSystemInfoSync can not use"),wx.canIUse("onAppShow")||console.error("onAppShow can not use"),wx.canIUse("onAppHide")||console.error("onAppHide can not use"),wx.canIUse("getLocation")||console.error("getLocation can not use"),wx.canIUse("onLocationChange")||console.error("onLocationChange can not use"),wx.canIUse("getNetworkType")||console.error("getNetworkType can not use"),wx.canIUse("onNetworkStatusChange")||console.error("onNetworkStatusChange can not use"),wx.canIUse("getUserInfo")||console.error("getUserInfo can not use"),wx.canIUse("getAccountInfoSync")||console.error("getAccountInfoSync can not use")},s.prototype.getLocation=function(){wx.getLocation({type:"wgs84",success:function(o){o.latitude,o.longitude,o.speed,o.accuracy,console.log("location",o)}})},s.prototype.location=function(){wx.onLocationChange(function(o){console.log("locationChange",o)})},s.prototype.destroy=function(){wx.offAppShow(),wx.offAppHide(),wx.offLocationChange(),wx.offNetworkStatusChange()},s.prototype.upload=function(){var o;(o=this).appMsg.et.common_info.client_time=(new Date).getTime(),wx.request({method:o.method,url:o.url,data:o.appMsg,header:{"content-type":"application/json"},success:function(o){console.log(o.data)}})},s.prototype.handle=function(o,e,n){!function(o,e,n,t){console.log(Array.prototype.slice.call(arguments)[0]),o.appMsg.et.event_name=n,o.appMsg.et.common_info.event_type=e,o.appMsg.et.common_info.others=t,o.upload()}(this,o,e,n)},o.Maidian=s,Object.defineProperty(o,"__esModule",{value:!0})});
